; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html

[platformio]
boards_dir = boards

[env:esp32p4]
platform = https://github.com/pioarduino/platform-espressif32/releases/download/55.03.34/platform-espressif32.zip
board = esp32p4_wifi6
framework = arduino
board_build.partitions = partitions.csv
board_build.flash_size = 32MB
board_build.sdkconfig_path = sdkconfig.defaults
custom_sdkconfig = 
	CONFIG_ESPTOOLPY_FLASHMODE_QIO=y
	CONFIG_BOOTLOADER_CACHE_32BIT_ADDR_FLASH=y
	CONFIG_SPIRAM=y
	CONFIG_SPIRAM_MODE_HEX=y
	CONFIG_SPIRAM_SPEED_200M=y
	CONFIG_ESP32P4_DEFAULT_CPU_FREQ_400=y
	CONFIG_ESP32P4_INSTRUCTION_CACHE_32KB=y
	CONFIG_ESP32P4_DATA_CACHE_32KB=y
build_unflags = -Os
build_flags = 
	-O2
	-DEL133UF1_SPI_SPEED=80000000
	-DUSE_PSRAM=1
	-DBOARD_HAS_PSRAM
	-DENABLE_WIFI_TEST=1
	-DPSY_ENABLE_SSL
	-DCONFIG_ESP_HTTPS_SERVER_ENABLE=1
	-DCONFIG_HTTPD_WS_SUPPORT=1
	-DCONFIG_FATFS_LFN_HEAP=1
	-DCONFIG_FATFS_MAX_LFN=255
	-DCONFIG_FATFS_USE_LABEL=1
	-DCONFIG_SOC_SDMMC_HOST_SUPPORTED=1
	-DLODEPNG_NO_COMPILE_ALLOCATORS
	-DPIN_SPI_SCK=3
	-DPIN_SPI_MOSI=2
	-DPIN_CS0=23
	-DPIN_CS1=48
	-DPIN_DC=26
	-DPIN_RESET=22
	-DPIN_BUSY=47
	-DPIN_RTC_SDA=31
	-DPIN_RTC_SCL=30
	-DPIN_RTC_INT=5
build_src_filter = 
	+<*>
lib_ignore = 
	esp32_sleep
monitor_speed = 115200
lib_deps = 
	kikuchan98/pngle@^1.1.0
	earlephilhower/ESP8266Audio@^1.9.9
	hoeken/PsychicHttp@^2.1.1
	; ArduinoJson removed - using cJSON instead (local library in lib/cjson)
extra_scripts = 
	pre:scripts/pre_build.py
	pre:scripts/fix_esp8266audio.py
	pre:scripts/generate_cert_header.py
	pre:scripts/generate_web_header.py
	pre:scripts/ensure_https_sdkconfig.py
build_type = release
